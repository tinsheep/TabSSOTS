{"version":3,"sources":["CaptureVideoDesktop.tsx"],"names":["react_1","require","microsoftTeams","react_northstar_1","CaptureVideoDesktop","_a","useState","MediaStream","setCapturedVideo","useEffect","initialize","React","createElement","Fragment","Card","CardHeader","Text","content","weight","CardBody","Flex","column","gap","Button","onClick","navigator","mediaDevices","getUserMedia","video","then","mediaStream","document","querySelector","srcObject","error","console","log","controls","exports"],"mappings":"mCAGA,IAAAA,QAAAC,QAAA,SACAC,eAAAD,QAAA,uBACAE,kBAAAF,QAAA,6BAMMG,oBAAsB,WAElB,IAAAC,EAAAL,QAAAM,SAAA,IAAAC,aAAgBC,GAAfH,EAAA,GAAeA,EAAA,IAgBtB,OAfAL,QAAAS,UAAU,WAENP,eAAeQ,eAcfC,MAAAC,cAAAD,MAAAE,SAAA,KAEIF,MAAAC,cAACT,kBAAAW,KAAI,KACDH,MAAAC,cAACT,kBAAAY,WAAU,KACPJ,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,2BAA2BC,OAAO,UAEpDP,MAAAC,cAACT,kBAAAgB,SAAQ,KACLR,MAAAC,cAACT,kBAAAiB,KAAI,CAACC,QAAM,EAACC,IAAI,aACbX,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,6CACdN,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,aAAaC,OAAO,aAClCP,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,cACdN,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,WAAWC,OAAO,aAChCP,MAAAC,cAACT,kBAAAa,KAAI,CAACC,QAAQ,wCACdN,MAAAC,cAACT,kBAAAoB,OAAM,CAACN,QAAQ,gBAAgBO,QAxBrD,WACKC,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IACxCC,KAAK,SAAAC,GACmBC,SAASC,cAAc,SAC9BC,UAAYH,EAC1BtB,EAAiBsB,KAEf,MAAC,SAAAI,GAAS,OAAAC,QAAQC,IAAIF,QAkBhBvB,MAAAC,cAAA,QAAA,CAAOyB,UAAQ,SAQvCC,QAAA,QAAelC","file":"CaptureVideoDesktop.min.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nimport { Card, Flex, Text, Button, CardHeader, CardBody } from '@fluentui/react-northstar'\r\n\r\n/**\r\n * The 'captureVideoDesktop' component\r\n * of your app.\r\n */\r\nconst CaptureVideoDesktop = () => {\r\n    //  var stream: MediaStream = null;\r\n    const [capturedVideo, setCapturedVideo] = useState(new MediaStream);\r\n    useEffect(() => {\r\n        // initializing microsoft teams sdk\r\n        microsoftTeams.initialize()\r\n    })\r\n\r\n   function captureVideo() {\r\n        navigator.mediaDevices.getUserMedia({ video: true })\r\n            .then(mediaStream => {\r\n                const videoElement = document.querySelector(\"video\");\r\n                videoElement!.srcObject = mediaStream;\r\n                setCapturedVideo(mediaStream);\r\n            })\r\n            .catch(error => console.log(error));\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* Card for showing Video */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <Text content=\"Capture Video (Web only)\" weight=\"bold\" />\r\n                </CardHeader>\r\n                <CardBody>\r\n                    <Flex column gap=\"gap.small\">\r\n                        <Text content=\"Checks for permission to use media input\" />\r\n                        <Text content=\"SDK used: \" weight=\"semibold\" />\r\n                        <Text content=\"navigator\" />\r\n                        <Text content=\"Method: \" weight=\"semibold\" />\r\n                        <Text content=\"navigator.mediaDevices.getUserMedia\" />\r\n                        <Button content=\"Capture video\" onClick={captureVideo} />\r\n                        <video controls ></video>\r\n                    </Flex>\r\n                </CardBody>\r\n            </Card>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default CaptureVideoDesktop;"]}