{"version":3,"sources":["Welcome.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+BAA6C;AAC7C,6DAAwD;AACxD,yBAAuB;AACvB,uCAAsC;AACtC,mDAAkD;AAClD,iCAAgC;AAChC,6CAA4C;AAC5C,0DAAmD;AACnD,mCAAkC;AAClC,qCAAoC;AACpC,sCAA4C;AAC5C,6DAAwD;AACxD,6DAAwD;AACxD,6DAAyD;AAEzD,SAAgB,OAAO,CAAC,KAAuD;IAA/E,iBA4EC;IA3EO,IAAA,uHAIL,EAJO,8BAAY,EAAE,4BAIrB,CAAC;IACF,IAAM,uBAAuB,GAC3B;QACE,KAAK,EAAE,mBAAmB;QAC1B,KAAK,EAAE,mBAAmB;KAC3B,CAAC,WAAW,CAAC,IAAI,mBAAmB,CAAC;IAExC,IAAM,KAAK,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;IAC5C,IAAM,iBAAiB,GAA8B;QACnD,KAAK,EAAE,2BAA2B;QAClC,KAAK,EAAE,sCAAsC;QAC7C,OAAO,EAAE,qBAAqB;KAC/B,CAAC;IACI,IAAA,8BAA2D,EAA1D,wBAAgB,EAAE,2BAAwC,CAAC;IAClE,IAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI;QAC3B,OAAO;YACL,GAAG,EAAE,IAAI;YACT,OAAO,EAAE,iBAAiB,CAAC,IAAI,CAAC,IAAI,EAAE;YACtC,OAAO,EAAE,cAAM,OAAA,mBAAmB,CAAC,IAAI,CAAC,EAAzB,CAAyB;SACzC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEK,IAAA,8DAAO,CAAgC;IACzC,IAAA;;;;;;;;;;;;;UAKJ,EALM,oBAAO,EAAE,cAAI,EAAE,gBAKrB,CAAC;IACH,IAAM,QAAQ,GAAG,CAAC,OAAO,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA,CAAC,CAAC,IAAK,CAAC,WAAW,CAAC;IAC5D,OAAO,CACL,6BAAK,SAAS,EAAC,cAAc;QAC3B,6BAAK,SAAS,EAAC,qBAAqB;YAClC,oBAAC,uBAAK,IAAC,GAAG,EAAC,WAAW,GAAG;YACzB,4BAAI,SAAS,EAAC,QAAQ;;gBAAiB,QAAQ,CAAC,CAAC,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,EAAE;oBAAO;YAC7E,2BAAG,SAAS,EAAC,QAAQ;;gBAA8B,uBAAuB,CAAK;YAC/E,oBAAC,sBAAI,IAAC,kBAAkB,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,QAAC,SAAS,SAAG;YAClE,6BAAK,SAAS,EAAC,UAAU;gBACtB,gBAAgB,KAAK,OAAO,IAAI,CAC/B;oBACE,oBAAC,mBAAQ,IAAC,YAAY,EAAE,YAAY,GAAI;oBACxC,oBAAC,yBAAW,IAAC,QAAQ,EAAE,QAAQ,GAAI;oBACnC,oBAAC,sBAAI,IAAC,OAAO,EAAE,CAAC;wBACd,oBAAC,yBAAO;wBACR,+CAA+C;;4BAA/C,+CAA+C;4BAC7C,OAAO,EAAE,oBAAC,gCAAmB,OAAG,GAChC;wBACF,oBAAC,yBAAO;wBACR,+CAA+C;;4BAA/C,+CAA+C;4BAC7C,OAAO,EAAE,oBAAC,gCAAmB,OAAG,GAChC,CACG;oBAEP,oBAAC,aAAK,OAAG;oBACR,YAAY,IAAI,oBAAC,+BAAc,OAAG,CAC/B,CACP;gBACA,gBAAgB,KAAK,OAAO,IAAI,CAC/B;oBACE,oBAAC,eAAM,OAAG,CACN,CACP;gBACA,gBAAgB,KAAK,SAAS,IAAI,CACjC;oBACE,oBAAC,iBAAO,OAAG,CACP,CACP,CACG,CACF,CACF,CACP,CAAC;AACJ,CAAC;AA5ED,0BA4EC","file":"Welcome.js","sourcesContent":["import { useContext, useState } from \"react\";\nimport { Image, Menu } from \"@fluentui/react-northstar\";\nimport \"./Welcome.css\";\nimport { EditCode } from \"./EditCode\";\nimport { AzureFunctions } from \"./AzureFunctions\";\nimport { Graph } from \"./Graph\";\nimport { CurrentUser } from \"./CurrentUser\";\nimport { useData } from \"@microsoft/teamsfx-react\";\nimport { Deploy } from \"./Deploy\";\nimport { Publish } from \"./Publish\";\nimport { TeamsFxContext } from \"../Context\";\nimport CaptureVideoDesktop from \"./CaptureVideoDesktop\";\nimport CaptureAudioDesktop from \"./CaptureAudioDesktop\";\nimport { Grid, Segment } from '@fluentui/react-northstar'\n\nexport function Welcome(props: { showFunction?: boolean; environment?: string }) {\n  const { showFunction, environment } = {\n    showFunction: true,\n    environment: window.location.hostname === \"localhost\" ? \"local\" : \"azure\",\n    ...props,\n  };\n  const friendlyEnvironmentName =\n    {\n      local: \"local environment\",\n      azure: \"Azure environment\",\n    }[environment] || \"local environment\";\n\n  const steps = [\"local\", \"azure\", \"publish\"];\n  const friendlyStepsName: { [key: string]: string } = {\n    local: \"1. Build your app locally\",\n    azure: \"2. Provision and Deploy to the Cloud\",\n    publish: \"3. Publish to Teams\",\n  };\n  const [selectedMenuItem, setSelectedMenuItem] = useState(\"local\");\n  const items = steps.map((step) => {\n    return {\n      key: step,\n      content: friendlyStepsName[step] || \"\",\n      onClick: () => setSelectedMenuItem(step),\n    };\n  });\n\n  const { teamsfx } = useContext(TeamsFxContext);\n  const { loading, data, error } = useData(async () => {\n    if (teamsfx) {\n      const userInfo = await teamsfx.getUserInfo();\n      return userInfo;\n    }\n  });\n  const userName = (loading || error) ? \"\": data!.displayName;\n  return (\n    <div className=\"welcome page\">\n      <div className=\"narrow page-padding\">\n        <Image src=\"hello.png\" />\n        <h1 className=\"center\">Congratulations{userName ? \", \" + userName : \"\"}!</h1>\n        <p className=\"center\">Your app is running in your {friendlyEnvironmentName}</p>\n        <Menu defaultActiveIndex={0} items={items} underlined secondary />\n        <div className=\"sections\">\n          {selectedMenuItem === \"local\" && (\n            <div>\n              <EditCode showFunction={showFunction} />\n              <CurrentUser userName={userName} />\n              <Grid columns={1}>\n                <Segment\n                /* Component to capture audio in web browser */\n                  content={<CaptureAudioDesktop />}\n                />\n                <Segment\n                /* Component to capture video in web browser */\n                  content={<CaptureVideoDesktop />}\n                />\n              </Grid>\n              \n              <Graph />\n              {showFunction && <AzureFunctions />}\n            </div>\n          )}\n          {selectedMenuItem === \"azure\" && (\n            <div>\n              <Deploy />\n            </div>\n          )}\n          {selectedMenuItem === \"publish\" && (\n            <div>\n              <Publish />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"]}