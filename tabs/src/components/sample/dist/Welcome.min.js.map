{"version":3,"sources":["Welcome.tsx"],"names":["react_1","require","react_northstar_1","EditCode_1","AzureFunctions_1","Graph_1","CurrentUser_1","teamsfx_react_1","Deploy_1","Publish_1","Context_1","CaptureVideoDesktop_1","CaptureAudioDesktop_1","react_northstar_2","Welcome","props","_this","this","_a","__assign","showFunction","environment","window","location","hostname","friendlyEnvironmentName","local","azure","friendlyStepsName","publish","_b","useState","selectedMenuItem","setSelectedMenuItem","items","map","step","key","content","onClick","teamsfx","useContext","TeamsFxContext","_c","useData","__awaiter","loading","data","error","userName","displayName","React","createElement","className","Image","src","Menu","defaultActiveIndex","underlined","secondary","EditCode","CurrentUser","Grid","columns","Segment","Graph","AzureFunctions","Deploy","Publish","exports"],"mappings":"2qDAAA,IAAAA,QAAAC,QAAA,SACAC,kBAAAD,QAAA,6BACAA,QAAA,iBACA,IAAAE,WAAAF,QAAA,cACAG,iBAAAH,QAAA,oBACAI,QAAAJ,QAAA,WACAK,cAAAL,QAAA,iBACAM,gBAAAN,QAAA,4BACAO,SAAAP,QAAA,YACAQ,UAAAR,QAAA,aACAS,UAAAT,QAAA,cACAU,sBAAAV,QAAA,yBACAW,sBAAAX,QAAA,yBACAY,kBAAAZ,QAAA,6BAEA,SAAgBa,QAAQC,GAAxB,IAAAC,EAAAC,KACQC,EAAAC,SAAA,CAAAC,cAAA,EAAAC,YAAA,cAAAC,OAAAC,SAAAC,SAAA,QAAA,SAAAT,GAAEK,EAAAF,EAAAE,aAKFK,EACJ,CACEC,MAAO,oBACPC,MAAO,qBARWT,EAAAG,cASF,oBAGdO,EAA+C,CACnDF,MAAO,4BACPC,MAAO,uCACPE,QAAS,uBAELC,EAAA9B,QAAA+B,SAAA,SAACC,EAAAF,EAAA,GAAkBG,EAAAH,EAAA,GACnBI,EAPQ,CAAC,QAAS,QAAS,WAObC,IAAI,SAACC,GACvB,MAAO,CACLC,IAAKD,EACLE,QAASV,EAAkBQ,IAAS,GACpCG,QAAS,WAAM,OAAAN,EAAoBG,OAI/BI,EAAAxC,QAAAyC,WAAA/B,UAAAgC,gBAAAF,QACFG,EAAApC,gBAAAqC,QAAA,WAAA,OAAAC,UAAA7B,OAAA,OAAA,EAAA,2JAAE8B,EAAAH,EAAAG,QAASC,EAAAJ,EAAAI,KAAMC,EAAAL,EAAAK,MAMjBC,EAAYH,GAAWE,EAAS,GAAID,EAAMG,YAChD,OACEC,MAAAC,cAAA,MAAA,CAAKC,UAAU,gBACbF,MAAAC,cAAA,MAAA,CAAKC,UAAU,uBACbF,MAAAC,cAAClD,kBAAAoD,MAAK,CAACC,IAAI,cACXJ,MAAAC,cAAA,KAAA,CAAIC,UAAU,4BAAyBJ,EAAW,KAAOA,EAAW,QACpEE,MAAAC,cAAA,IAAA,CAAGC,UAAU,yCAAsC5B,GACnD0B,MAAAC,cAAClD,kBAAAsD,KAAI,CAACC,mBAAoB,EAAGvB,MAAOA,EAAOwB,YAAU,EAACC,WAAS,IAC/DR,MAAAC,cAAA,MAAA,CAAKC,UAAU,YACS,UAArBrB,GACCmB,MAAAC,cAAA,MAAA,KACED,MAAAC,cAACjD,WAAAyD,SAAQ,CAACxC,aAAcA,IACxB+B,MAAAC,cAAC9C,cAAAuD,YAAW,CAACZ,SAAUA,IACvBE,MAAAC,cAACvC,kBAAAiD,KAAI,CAACC,QAAS,GACbZ,MAAAC,cAACvC,kBAAAmD,SAEC1B,QAASa,MAAAC,cAACxC,sBAAA,QAAmB,QAE/BuC,MAAAC,cAACvC,kBAAAmD,SAEC1B,QAASa,MAAAC,cAACzC,sBAAA,QAAmB,SAIjCwC,MAAAC,cAAC/C,QAAA4D,MAAK,MACL7C,GAAgB+B,MAAAC,cAAChD,iBAAA8D,eAAc,OAGd,UAArBlC,GACCmB,MAAAC,cAAA,MAAA,KACED,MAAAC,cAAC5C,SAAA2D,OAAM,OAGW,YAArBnC,GACCmB,MAAAC,cAAA,MAAA,KACED,MAAAC,cAAC3C,UAAA2D,QAAO,UArEtBC,QAAAvD,QAAAA","file":"Welcome.min.js","sourcesContent":["import { useContext, useState } from \"react\";\nimport { Image, Menu } from \"@fluentui/react-northstar\";\nimport \"./Welcome.css\";\nimport { EditCode } from \"./EditCode\";\nimport { AzureFunctions } from \"./AzureFunctions\";\nimport { Graph } from \"./Graph\";\nimport { CurrentUser } from \"./CurrentUser\";\nimport { useData } from \"@microsoft/teamsfx-react\";\nimport { Deploy } from \"./Deploy\";\nimport { Publish } from \"./Publish\";\nimport { TeamsFxContext } from \"../Context\";\nimport CaptureVideoDesktop from \"./CaptureVideoDesktop\";\nimport CaptureAudioDesktop from \"./CaptureAudioDesktop\";\nimport { Grid, Segment } from '@fluentui/react-northstar'\n\nexport function Welcome(props: { showFunction?: boolean; environment?: string }) {\n  const { showFunction, environment } = {\n    showFunction: true,\n    environment: window.location.hostname === \"localhost\" ? \"local\" : \"azure\",\n    ...props,\n  };\n  const friendlyEnvironmentName =\n    {\n      local: \"local environment\",\n      azure: \"Azure environment\",\n    }[environment] || \"local environment\";\n\n  const steps = [\"local\", \"azure\", \"publish\"];\n  const friendlyStepsName: { [key: string]: string } = {\n    local: \"1. Build your app locally\",\n    azure: \"2. Provision and Deploy to the Cloud\",\n    publish: \"3. Publish to Teams\",\n  };\n  const [selectedMenuItem, setSelectedMenuItem] = useState(\"local\");\n  const items = steps.map((step) => {\n    return {\n      key: step,\n      content: friendlyStepsName[step] || \"\",\n      onClick: () => setSelectedMenuItem(step),\n    };\n  });\n\n  const { teamsfx } = useContext(TeamsFxContext);\n  const { loading, data, error } = useData(async () => {\n    if (teamsfx) {\n      const userInfo = await teamsfx.getUserInfo();\n      return userInfo;\n    }\n  });\n  const userName = (loading || error) ? \"\": data!.displayName;\n  return (\n    <div className=\"welcome page\">\n      <div className=\"narrow page-padding\">\n        <Image src=\"hello.png\" />\n        <h1 className=\"center\">Congratulations{userName ? \", \" + userName : \"\"}!</h1>\n        <p className=\"center\">Your app is running in your {friendlyEnvironmentName}</p>\n        <Menu defaultActiveIndex={0} items={items} underlined secondary />\n        <div className=\"sections\">\n          {selectedMenuItem === \"local\" && (\n            <div>\n              <EditCode showFunction={showFunction} />\n              <CurrentUser userName={userName} />\n              <Grid columns={1}>\n                <Segment\n                /* Component to capture audio in web browser */\n                  content={<CaptureAudioDesktop />}\n                />\n                <Segment\n                /* Component to capture video in web browser */\n                  content={<CaptureVideoDesktop />}\n                />\n              </Grid>\n              \n              <Graph />\n              {showFunction && <AzureFunctions />}\n            </div>\n          )}\n          {selectedMenuItem === \"azure\" && (\n            <div>\n              <Deploy />\n            </div>\n          )}\n          {selectedMenuItem === \"publish\" && (\n            <div>\n              <Publish />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"]}