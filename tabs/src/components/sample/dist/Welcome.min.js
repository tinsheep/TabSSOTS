"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,c,l,u){return new(l=l||Promise)(function(t,r){function n(e){try{o(u.next(e))}catch(e){r(e)}}function a(e){try{o(u.throw(e))}catch(e){r(e)}}function o(e){e.done?t(e.value):function(t){return t instanceof l?t:new l(function(e){e(t)})}(e.value).then(n,a)}o((u=u.apply(e,c||[])).next())})},__generator=this&&this.__generator||function(r,n){var a,o,c,e,l={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,o&&(c=2&t[0]?o.return:t[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,t[1])).done)return c;switch(o=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(c=0<(c=l.trys).length&&c[c.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){l.label=t[1];break}if(6===t[0]&&l.label<c[1]){l.label=c[1],c=t;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(t);break}c[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(r,l)}catch(e){t=[6,e],o=0}finally{a=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};exports.__esModule=!0;var react_1=require("react"),react_northstar_1=require("@fluentui/react-northstar");require("./Welcome.css");var EditCode_1=require("./EditCode"),AzureFunctions_1=require("./AzureFunctions"),Graph_1=require("./Graph"),CurrentUser_1=require("./CurrentUser"),teamsfx_react_1=require("@microsoft/teamsfx-react"),Deploy_1=require("./Deploy"),Publish_1=require("./Publish"),Context_1=require("../Context"),CaptureVideoDesktop_1=require("./CaptureVideoDesktop"),CaptureAudioDesktop_1=require("./CaptureAudioDesktop"),react_northstar_2=require("@fluentui/react-northstar");function Welcome(e){var t=this,r=__assign({showFunction:!0,environment:"localhost"===window.location.hostname?"local":"azure"},e),n=r.showFunction,a={local:"local environment",azure:"Azure environment"}[r.environment]||"local environment",o={local:"1. Build your app locally",azure:"2. Provision and Deploy to the Cloud",publish:"3. Publish to Teams"},c=react_1.useState("local"),l=c[0],u=c[1],i=["local","azure","publish"].map(function(e){return{key:e,content:o[e]||"",onClick:function(){return u(e)}}}),s=react_1.useContext(Context_1.TeamsFxContext).teamsfx,_=teamsfx_react_1.useData(function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return s?[4,s.getUserInfo()]:[3,2];case 1:return[2,e.sent()];case 2:return[2]}})})}),p=_.loading,h=_.data,m=_.error,f=p||m?"":h.displayName;return React.createElement("div",{className:"welcome page"},React.createElement("div",{className:"narrow page-padding"},React.createElement(react_northstar_1.Image,{src:"hello.png"}),React.createElement("h1",{className:"center"},"Congratulations",f?", "+f:"","!"),React.createElement("p",{className:"center"},"Your app is running in your ",a),React.createElement(react_northstar_1.Menu,{defaultActiveIndex:0,items:i,underlined:!0,secondary:!0}),React.createElement("div",{className:"sections"},"local"===l&&React.createElement("div",null,React.createElement(EditCode_1.EditCode,{showFunction:n}),React.createElement(CurrentUser_1.CurrentUser,{userName:f}),React.createElement(react_northstar_2.Grid,{columns:1},React.createElement(react_northstar_2.Segment,{content:React.createElement(CaptureAudioDesktop_1.default,null)}),React.createElement(react_northstar_2.Segment,{content:React.createElement(CaptureVideoDesktop_1.default,null)})),React.createElement(Graph_1.Graph,null),n&&React.createElement(AzureFunctions_1.AzureFunctions,null)),"azure"===l&&React.createElement("div",null,React.createElement(Deploy_1.Deploy,null)),"publish"===l&&React.createElement("div",null,React.createElement(Publish_1.Publish,null)))))}exports.Welcome=Welcome;
//# sourceMappingURL=Welcome.min.js.map
